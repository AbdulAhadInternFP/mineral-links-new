@php
    $invoiceItems = [
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'PARKS BELL PSA N4005H',
            'cdlr_code' => '7630489G0001',
            'mw_property' => '1181110',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '02/01/2025',
            'product_type' => 'Gas',
            'product_unit' => 'MCF',
            'gross_volume' => '7,548.39',
            'net_volume' => '9.29',
            'gross_revenue' => '$23.81',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '$23.81',
            'decimal_interest' => '0.00112957',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'PARKS BELL PSA N4005H',
            'cdlr_code' => '7630496G0001',
            'mw_property' => '1181110',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '02/01/2025',
            'product_type' => 'LNG',
            'product_unit' => 'GAL',
            'gross_volume' => '0',
            'net_volume' => '0',
            'gross_revenue' => '$0.00',
            'severance' => '$0.00',
            'deduction' => '($0.14)',
            'deduction_type' => 'Transportation - Gas',
            'net_revenue' => '($0.14)',
            'decimal_interest' => '0.00112957',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'mismatched',
            'mismatch_reason' => 'Volume mismatch',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'PARKS BELL PSA N4005H',
            'cdlr_code' => '7630489G0001',
            'mw_property' => '1181110',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '02/01/2025',
            'product_type' => 'LNG',
            'product_unit' => 'GAL',
            'gross_volume' => '50,464.83',
            'net_volume' => '62.05',
            'gross_revenue' => '$31.72',
            'severance' => '$0.00',
            'deduction' => '($1.14)',
            'deduction_type' => 'Processing and/or Sweetening',
            'net_revenue' => '$30.58',
            'decimal_interest' => '0.00112957',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'PARKS BELL 4007AH N4007AH',
            'cdlr_code' => '7630490G0001',
            'mw_property' => '1181111',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '04/01/2025',
            'product_type' => 'Gas',
            'product_unit' => 'MCF',
            'gross_volume' => '4,118.07',
            'net_volume' => '4.57',
            'gross_revenue' => '$11.72',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '$11.72',
            'decimal_interest' => '0.00110881',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'PARKS BELL 4007AH N4007AH',
            'cdlr_code' => '7630490G0001',
            'mw_property' => '1181112',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '03/01/2025',
            'product_type' => 'LNG',
            'product_unit' => 'GAL',
            'gross_volume' => '27,532.14',
            'net_volume' => '30.53',
            'gross_revenue' => '$18.57',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '$18.57',
            'decimal_interest' => '0.00110881',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'PARKS BELL 4007AH N4007AH',
            'cdlr_code' => '7630490G0001',
            'mw_property' => '1181112',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '03/01/2025',
            'product_type' => 'Oil',
            'product_unit' => 'BBL',
            'gross_volume' => '0',
            'net_volume' => '0',
            'gross_revenue' => '$0.00',
            'severance' => '$0.00',
            'deduction' => '($0.03)',
            'deduction_type' => 'Transportation - Gas',
            'net_revenue' => '($0.03)',
            'decimal_interest' => '0.00110881',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'mismatched',
            'mismatch_reason' => 'Missing on EnergyLink',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'PARKS BELL PSA N4005H',
            'cdlr_code' => '7630430O0001',
            'mw_property' => '1181111',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '04/01/2025',
            'product_type' => 'Oil',
            'product_unit' => 'BBL',
            'gross_volume' => '3,008.59',
            'net_volume' => '3.70',
            'gross_revenue' => '$239.17',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '$239.17',
            'decimal_interest' => '0.00110881',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'PARKS BELL 4007AH N4007AH',
            'cdlr_code' => '7630430O0001',
            'mw_property' => '1181111',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '04/01/2025',
            'product_type' => 'Oil',
            'product_unit' => 'BBL',
            'gross_volume' => '3,778.74',
            'net_volume' => '4.19',
            'gross_revenue' => '$264.27',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '$264.27',
            'decimal_interest' => '0.00110881',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'RATLIFF A 28 E HZ UN 2802AH',
            'cdlr_code' => '7655116G0001',
            'mw_property' => '1181114',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '02/01/2025',
            'product_type' => 'Gas',
            'product_unit' => 'MCF',
            'gross_volume' => '9,782.41',
            'net_volume' => '10.81',
            'gross_revenue' => '$27.78',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '$27.78',
            'decimal_interest' => '0.00110468',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'RATLIFF A 28 E HZ UN 2802AH',
            'cdlr_code' => '7655116G0001',
            'mw_property' => '1181114',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '02/01/2025',
            'product_type' => 'LNG',
            'product_unit' => 'GAL',
            'gross_volume' => '0',
            'net_volume' => '0',
            'gross_revenue' => '$63.71',
            'severance' => '$0.00',
            'deduction' => '($2.40)',
            'deduction_type' => 'Transportation - Gas',
            'net_revenue' => '$61.31',
            'decimal_interest' => '0.00110468',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'mismatched',
            'mismatch_reason' => 'Amount variance',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'RATLIFF A 28 E HZ UN 2802AH',
            'cdlr_code' => '7655116G0001',
            'mw_property' => '1181114',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '02/01/2025',
            'product_type' => 'LNG',
            'product_unit' => 'GAL',
            'gross_volume' => '85,438.43',
            'net_volume' => '98.80',
            'gross_revenue' => '$0.00',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '$0.00',
            'decimal_interest' => '0.00110468',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'RATLIFF A 28 E HZ UN 2802AH',
            'cdlr_code' => '7655110O0001',
            'mw_property' => '1181114',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '02/01/2025',
            'product_type' => 'Oil',
            'product_unit' => 'BBL',
            'gross_volume' => '0',
            'net_volume' => '0',
            'gross_revenue' => '$201.70',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '$201.70',
            'decimal_interest' => '0.00110468',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'RATLIFF A 28 E HZ UN 2802LH',
            'cdlr_code' => '7655120G0001',
            'mw_property' => '1181115',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '03/01/2025',
            'product_type' => 'Gas',
            'product_unit' => 'MCF',
            'gross_volume' => '2,894.88',
            'net_volume' => '3.20',
            'gross_revenue' => '$17.86',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '$17.86',
            'decimal_interest' => '0.00110468',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'RATLIFF A 28 E HZ UN 2801H',
            'cdlr_code' => '7655126G0001',
            'mw_property' => '1181116',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '03/01/2025',
            'product_type' => 'Gas',
            'product_unit' => 'MCF',
            'gross_volume' => '6,290.09',
            'net_volume' => '6.95',
            'gross_revenue' => '$0.00',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '$0.00',
            'decimal_interest' => '0.00110392',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'RATLIFF A 28 E HZ UN 2801H',
            'cdlr_code' => '7655126G0001',
            'mw_property' => '1181116',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '03/01/2025',
            'product_type' => 'LNG',
            'product_unit' => 'GAL',
            'gross_volume' => '57,491.32',
            'net_volume' => '63.55',
            'gross_revenue' => '$60.94',
            'severance' => '$0.00',
            'deduction' => '($1.87)',
            'deduction_type' => 'Processing',
            'net_revenue' => '$59.07',
            'decimal_interest' => '0.00110392',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'RATLIFF A N2109AH',
            'cdlr_code' => '7655130G0001',
            'mw_property' => '1181117',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '04/01/2025',
            'product_type' => 'LNG',
            'product_unit' => 'GAL',
            'gross_volume' => '3,002.86',
            'net_volume' => '3.32',
            'gross_revenue' => '$289.19',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '$289.19',
            'decimal_interest' => '0.00110392',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'RATLIFF A N2109AH',
            'cdlr_code' => '7655130G0001',
            'mw_property' => '1181117',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '04/01/2025',
            'product_type' => 'Oil',
            'product_unit' => 'BBL',
            'gross_volume' => '0',
            'net_volume' => '0',
            'gross_revenue' => '($23.66)',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '($23.66)',
            'decimal_interest' => '0.00110392',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'mismatched',
            'mismatch_reason' => 'Missing data',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'RATLIFF G H28011S',
            'cdlr_code' => '7026076G0001',
            'mw_property' => '1181118',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '02/01/2025',
            'product_type' => 'Gas',
            'product_unit' => 'MCF',
            'gross_volume' => '6,594.97',
            'net_volume' => '7.29',
            'gross_revenue' => '$298.55',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '$298.55',
            'decimal_interest' => '0.00110468',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
        [
            'payor' => 'CONOCOPHILLIPS CO.',
            'property' => 'RATLIFF G H28011S',
            'cdlr_code' => '7026076G0001',
            'mw_property' => '1181118',
            'state' => 'Texas',
            'county' => 'Ector',
            'basin' => 'Midland Basin',
            'prod_date' => '02/01/2025',
            'product_type' => 'Oil',
            'product_unit' => 'BBL',
            'gross_volume' => '1,069.28',
            'net_volume' => '1.18',
            'gross_revenue' => '$1.93',
            'severance' => '$0.00',
            'deduction' => '$0.00',
            'deduction_type' => '-',
            'net_revenue' => '$1.93',
            'decimal_interest' => '0.00110468',
            'interest_type' => 'ORRI',
            'check_date' => '05/23/2025',
            'deposit_date' => '06/12/2025',
            'check_number' => '1805156',
            'check_amount' => '$5,647.30',
            'owner_number' => '1168181357',
            'asset' => 'Ector/Midland, TX Parks Bell - David Rogers',
            'status' => 'matched',
        ],
    ];

    $totalItems = count($invoiceItems);
    $matchedCount = count(array_filter($invoiceItems, fn($item) => $item['status'] === 'matched'));
    $mismatchedCount = count(array_filter($invoiceItems, fn($item) => $item['status'] === 'mismatched'));
@endphp

<x-layout title="Transaction Details">
    <section id="back_navigation" class="mb-4">
        <a href="{{ route('admin.invoices') }}"
            class="inline-flex items-center px-6 py-2 text-sm font-bold text-white bg-[#D6A77A] rounded-xl hover:bg-[#C59669] transition-colors shadow-sm">
            <i class="fa-solid fa-arrow-left-long mr-2"></i>
            <span>Back</span>
        </a>
    </section>

    <div id="reconciliation_alert"
        class="flex items-center justify-between bg-white border-l-4 border-brand-terracotta rounded-r-lg shadow-sm px-6 py-4 mb-6">
        <div class="flex items-center">
            <div class="flex-shrink-0">
                <i class="fa-solid fa-triangle-exclamation text-brand-terracotta text-xl"></i>
            </div>
            <div class="ml-4">
                <p class="font-medium text-gray-900">Attention Required</p>
                <p class="text-sm text-gray-500">{{ $mismatchedCount }} line items need reconciliation.</p>
            </div>
        </div>
        <button
            class="px-4 py-2 text-sm font-medium text-white bg-brand-terracotta rounded-xl hover:bg-brand-terracotta/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-terracotta transition-colors">
            Report Issue
        </button>
    </div>

    <section id="tabs_and_actions_row" class="bg-white rounded-xl shadow px-6 py-3 mb-6">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">

                <div class="h-6 w-px bg-gray-200"></div>
                <div class="flex items-center space-x-2">
                    <button
                        class="filter-tab active flex items-center space-x-2 px-5 py-2.5 rounded-full text-sm font-semibold bg-brand-teal text-white transition-colors"
                        data-filter="all">
                        <span>All</span>
                        <span
                            class="inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold bg-white/20 text-white rounded-full">{{ $totalItems }}</span>
                    </button>
                    <button
                        class="filter-tab flex items-center space-x-2 px-5 py-2.5 rounded-full text-sm font-semibold bg-transparent text-gray-600 hover:bg-gray-100 transition-colors"
                        data-filter="matched">
                        <span>Matched</span>
                        <span
                            class="inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold bg-brand-teal/20 text-brand-teal rounded-full">{{ $matchedCount }}</span>
                    </button>
                    <button
                        class="filter-tab flex items-center space-x-2 px-5 py-2.5 rounded-full text-sm font-semibold bg-transparent text-gray-600 hover:bg-gray-100 transition-colors"
                        data-filter="mismatched">
                        <span>Mismatched</span>
                        <span
                            class="inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold bg-brand-teal/20 text-brand-teal rounded-full">{{ $mismatchedCount }}</span>
                    </button>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <input type="text" placeholder="Search items..."
                            class="w-60 h-11 pl-10 pr-4 border border-gray-300 rounded-lg focus:outline-none focus:border-brand-sage text-sm">
                        <i
                            class="fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    </div>

                </div>
            </div>
    </section>

    <section id="invoices_table_section" class="bg-white rounded-xl shadow overflow-hidden">
        <div class="overflow-x-auto overflow-y-auto max-h-[500px]">
            <table class="w-full min-w-[2800px]">
                <thead class="bg-gray-50 border-b border-gray-200 sticky top-0 z-10">
                    <tr>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Customer Name</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Property Name</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            CDLR Property Code</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            MW Property</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            State</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            County</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Basin</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Production Date</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Product Type</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Product Unit</th>
                        <th
                            class="px-4 py-1.5 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Gross Volume</th>
                        <th
                            class="px-4 py-1.5 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Net Volume</th>
                        <th
                            class="px-4 py-1.5 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Gross Revenue</th>
                        <th
                            class="px-4 py-1.5 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Severance</th>
                        <th
                            class="px-4 py-1.5 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Deduction</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Deduction Type</th>
                        <th
                            class="px-4 py-1.5 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Net Revenue</th>
                        <th
                            class="px-4 py-1.5 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Decimal Interest</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Interest Type</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Check Date</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Deposit Date</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Check Number</th>
                        <th
                            class="px-4 py-1.5 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Check Amount</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Owner Number</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Asset</th>
                        <th
                            class="px-4 py-1.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider whitespace-nowrap">
                            Status</th>
                    </tr>
                </thead>
                <tbody id="invoices-table-body" class="divide-y divide-gray-200">
                    @foreach ($invoiceItems as $index => $item)
                        @php
                            $isMismatched = $item['status'] === 'mismatched';
                            $isAlternate = $index % 2 === 1;
                            $rowClass = $isMismatched
                                ? 'bg-[#FFF7EF] hover:bg-[#F8EBD9]'
                                : ($isAlternate
                                    ? 'bg-brand-sage/5 hover:bg-brand-sage/10'
                                    : 'hover:bg-brand-sage/10');
                        @endphp
                        <tr class="{{ $rowClass }} transition-colors invoice-row"
                            data-status="{{ $item['status'] }}">
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-900">{{ $item['payor'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm font-medium text-gray-900">{{ $item['property'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm font-semibold text-brand-teal">{{ $item['cdlr_code'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-700">{{ $item['mw_property'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-700">{{ $item['state'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-700">{{ $item['county'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-700">{{ $item['basin'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-700">{{ $item['prod_date'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap">
                                @if ($isMismatched)
                                    <div class="flex items-center">
                                        <span class="text-sm text-gray-900">{{ $item['product_type'] }}</span>
                                        <i class="fa-solid fa-triangle-exclamation text-[#D6A77A] ml-2"
                                            title="{{ $item['mismatch_reason'] ?? 'Mismatch' }}"></i>
                                    </div>
                                @else
                                    <span class="text-sm text-gray-900">{{ $item['product_type'] }}</span>
                                @endif
                            </td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-700">{{ $item['product_unit'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap text-right"><span
                                    class="text-sm font-mono text-gray-700">{{ $item['gross_volume'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap text-right"><span
                                    class="text-sm font-mono text-gray-700">{{ $item['net_volume'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap text-right"><span
                                    class="text-sm font-mono text-gray-900">{{ $item['gross_revenue'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap text-right"><span
                                    class="text-sm font-mono text-gray-700">{{ $item['severance'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap text-right"><span
                                    class="text-sm font-mono text-gray-700">{{ $item['deduction'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-700">{{ $item['deduction_type'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap text-right"><span
                                    class="text-sm font-mono font-semibold text-gray-900">{{ $item['net_revenue'] }}</span>
                            </td>
                            <td class="px-4 py-1.5 whitespace-nowrap text-right"><span
                                    class="text-sm font-mono text-gray-700">{{ $item['decimal_interest'] }}</span>
                            </td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-700">{{ $item['interest_type'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-700">{{ $item['check_date'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-700">{{ $item['deposit_date'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-700">{{ $item['check_number'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap text-right"><span
                                    class="text-sm font-mono text-gray-900">{{ $item['check_amount'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-700">{{ $item['owner_number'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap"><span
                                    class="text-sm text-gray-700">{{ $item['asset'] }}</span></td>
                            <td class="px-4 py-1.5 whitespace-nowrap text-left">
                                @if ($isMismatched)
                                    <span
                                        class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-[#D6A77A] text-white">Mismatched</span>
                                @else
                                    <span
                                        class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-status-success text-white">Matched</span>
                                @endif
                            </td>
                        </tr>
                    @endforeach
                </tbody>
            </table>
        </div>

        <!-- Pagination Footer -->
        <div class="px-6 py-4 border-t border-gray-200 flex items-center justify-between">
            <div class="flex items-center space-x-2">
                <span class="text-sm text-gray-600">Show</span>
                <select id="rows-per-page"
                    class="border border-gray-300 rounded-lg text-sm px-2 py-1 focus:outline-none focus:border-brand-teal">
                    <option value="10">10</option>
                    <option value="20" selected>20</option>
                    <option value="100">100</option>
                </select>
                <span class="text-sm text-gray-600">entries</span>
            </div>
            <div class="text-sm text-gray-600">
                Showing <span id="start-index">1</span> to <span id="end-index">{{ $totalItems }}</span> of <span
                    id="total-entries">{{ $totalItems }}</span> entries
            </div>
            <div class="flex items-center space-x-1">
                <button id="prev-page"
                    class="px-3 py-1.5 rounded-lg border border-gray-300 text-sm text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">Previous</button>
                <div id="pagination-numbers" class="flex items-center space-x-1">
                    <span class="px-3 py-1.5 rounded-lg bg-brand-teal text-white text-sm font-medium">1</span>
                </div>
                <button id="next-page"
                    class="px-3 py-1.5 rounded-lg border border-gray-300 text-sm text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">Next</button>
            </div>
        </div>

        <!-- Footer with Post to QB button -->
        <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 flex items-center justify-between">
            <div class="text-sm text-gray-600">
                <span class="font-medium">{{ $matchedCount }}</span> matched line items ready to post
            </div>
            <div class="flex gap-3">
                <button
                    class="bg-brand-terracotta text-white font-semibold px-6 py-2.5 rounded-lg hover:bg-brand-terracotta/90 transition-colors text-sm flex items-center">
                    <i class="fa-solid fa-rotate-left mr-2"></i>
                    Roll Back
                </button>

                <a href="{{ route('admin.invoice.summarize') }}"
                    class="bg-brand-teal text-white font-semibold px-6 py-2.5 rounded-lg hover:bg-brand-teal/90 transition-colors text-sm flex items-center">
                    <i class="fa-solid fa-chart-simple mr-2"></i>
                    Summarize Now
                </a>
            </div>
        </div>
    </section>

    <!-- View Modal -->
    <div id="view-modal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-[0_8px_32px_rgba(0,0,0,0.12)] w-[520px] max-h-[90vh] overflow-hidden">
            <div class="flex items-center justify-between px-6 py-4 border-b border-gray-200">
                <div class="flex items-center space-x-3">
                    <h3 class="text-xl font-semibold text-gray-900" id="view-modal-title">Line Item Details</h3>
                </div>
                <button class="modal-close text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fa-solid fa-xmark fa-lg"></i>
                </button>
            </div>
            <div class="px-6 py-5 space-y-4">
                <div class="flex items-center justify-between py-3 border-b border-gray-100">
                    <span class="text-sm font-medium text-gray-500">CDLR Code</span>
                    <span class="text-sm font-semibold text-brand-teal" id="view-modal-invoice">-</span>
                </div>
                <div class="flex items-center justify-between py-3 border-b border-gray-100">
                    <span class="text-sm font-medium text-gray-500">Property</span>
                    <span class="text-sm font-semibold text-gray-900" id="view-modal-entity">-</span>
                </div>
                <div class="flex items-center justify-between py-3 border-b border-gray-100">
                    <span class="text-sm font-medium text-gray-500">Product Type</span>
                    <span class="text-sm font-semibold text-gray-900" id="view-modal-product">-</span>
                </div>
                <div class="flex items-center justify-between py-3 border-b border-gray-100">
                    <span class="text-sm font-medium text-gray-500">Gross Volume</span>
                    <span class="text-sm font-mono text-gray-900" id="view-modal-volume">-</span>
                </div>
                <div class="flex items-center justify-between py-3 border-b border-gray-100">
                    <span class="text-sm font-medium text-gray-500">Net Revenue</span>
                    <span class="text-lg font-semibold font-mono text-gray-900" id="view-modal-amount">-</span>
                </div>
                <div class="flex items-center justify-between py-3">
                    <span class="text-sm font-medium text-gray-500">Status</span>
                    <span id="view-modal-status"
                        class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-status-success text-white">Matched</span>
                </div>
            </div>
            <div class="flex items-center justify-end space-x-3 px-6 py-4 bg-gray-50 border-t border-gray-200">
                <button
                    class="modal-close px-4 py-2 text-gray-700 hover:text-gray-900 transition-colors text-sm font-medium">Close</button>
            </div>
        </div>
    </div>
</x-layout>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const filterTabs = document.querySelectorAll('.filter-tab');
        const invoiceRows = document.querySelectorAll('.invoice-row');
        const syncDataBtn = document.getElementById('sync-data-btn');
        const postToQbBtn = document.getElementById('post-to-qb-btn');
        const viewModal = document.getElementById('view-modal');

        // Filter tabs functionality
        filterTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                filterTabs.forEach(t => {
                    t.classList.remove('active', 'bg-brand-teal', 'text-white');
                    t.classList.add('bg-transparent', 'text-gray-600');

                    // Reset pill styles for inactive tabs
                    const pill = t.querySelector('span:last-child');
                    if (pill) {
                        pill.classList.remove('bg-white/20', 'text-white');
                        pill.classList.add('bg-brand-teal/20', 'text-brand-teal');
                    }
                });
                this.classList.add('active', 'bg-brand-teal', 'text-white');
                this.classList.remove('bg-transparent', 'text-gray-600');

                // Set pill styles for active tab
                const pill = this.querySelector('span:last-child');
                if (pill) {
                    pill.classList.remove('bg-brand-teal/20', 'text-brand-teal');
                    pill.classList.add('bg-white/20', 'text-white');
                }

                const filter = this.dataset.filter;
                invoiceRows.forEach(row => {
                    if (filter === 'all') {
                        row.style.display = '';
                    } else {
                        row.style.display = row.dataset.status === filter ? '' : 'none';
                    }
                });
            });
        });

        // Sync data button
        syncDataBtn.addEventListener('click', function() {
            const icon = this.querySelector('i');
            icon.classList.add('fa-spin');
            this.disabled = true;

            setTimeout(() => {
                icon.classList.remove('fa-spin');
                this.disabled = false;
                showToast('Data synced successfully.');
            }, 2000);
        });

        // Post to QB button
        postToQbBtn.addEventListener('click', function() {
            this.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i>Posting...';
            this.disabled = true;

            setTimeout(() => {
                this.innerHTML = '<i class="fa-solid fa-check mr-2"></i>Posted Successfully';
                this.classList.remove('bg-brand-teal', 'hover:bg-brand-teal/90');
                this.classList.add('bg-status-success');
                showToast('Line items posted to QuickBooks successfully.');

                invoiceRows.forEach(row => {
                    if (row.dataset.status === 'matched') {
                        row.dataset.status = 'posted';
                        const statusBadge = row.querySelector('td:last-child span');
                        if (statusBadge) {
                            statusBadge.textContent = 'Posted';
                            statusBadge.className =
                                'inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-[#4A90A4] text-white';
                        }
                    }
                });
            }, 2000);
        });

        // Row click to open view modal
        invoiceRows.forEach(row => {
            row.addEventListener('click', function() {
                const cells = this.querySelectorAll('td');
                const cdlrCode = cells[2]?.querySelector('span')?.textContent || '-';
                const property = cells[1]?.querySelector('span')?.textContent || '-';
                const productType = cells[8]?.querySelector('span')?.textContent || '-';
                const grossVolume = cells[10]?.querySelector('span')?.textContent || '-';
                const netRevenue = cells[16]?.querySelector('span')?.textContent || '-';
                const status = this.dataset.status;

                document.getElementById('view-modal-invoice').textContent = cdlrCode;
                document.getElementById('view-modal-entity').textContent = property;
                document.getElementById('view-modal-product').textContent = productType;
                document.getElementById('view-modal-volume').textContent = grossVolume;
                document.getElementById('view-modal-amount').textContent = netRevenue;

                const statusEl = document.getElementById('view-modal-status');
                if (status === 'matched') {
                    statusEl.textContent = 'Matched';
                    statusEl.className =
                        'inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-status-success text-white';
                } else if (status === 'mismatched') {
                    statusEl.textContent = 'Mismatched';
                    statusEl.className =
                        'inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-[#D6A77A] text-white';
                } else {
                    statusEl.textContent = 'Posted';
                    statusEl.className =
                        'inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-[#4A90A4] text-white';
                }

                viewModal.classList.remove('hidden');
                viewModal.classList.add('flex');
            });
        });

        // Modal close functionality
        document.querySelectorAll('.modal-close').forEach(btn => {
            btn.addEventListener('click', function() {
                this.closest('.fixed').classList.add('hidden');
                this.closest('.fixed').classList.remove('flex');
            });
        });

        document.querySelectorAll('.fixed').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.add('hidden');
                    this.classList.remove('flex');
                }
            });
        });

        // Toast notification
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className =
                'fixed top-4 right-4 bg-brand-teal text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center space-x-2';
            toast.innerHTML = `<i class="fa-solid fa-check-circle"></i><span>${message}</span>`;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
    });
</script>
